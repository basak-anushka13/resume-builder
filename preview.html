<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>Resume Preview | Élevé</title>
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #fff;
      color: #000;
      margin: 0;
      padding: 20px;
    }
    .resume-container {
      max-width: 800px;
      margin: auto;
      padding: 40px;
      background: white;
      border: 1px solid #000;
    }

    h1, h2, h3 {
      margin: 10px 0 5px;
      font-weight: 600;
    }
    .section {
      margin-top: 30px;
    }

    .section ul {
      padding-left: 20px;
    }

    .contact-info, .location {
      font-size: 14px;
      margin-top: 5px;
    }

    .divider {
      border-top: 1px solid #000;
      margin: 20px 0;
    }

    #download-btn {
      display: block;
      margin: 30px auto;
      padding: 12px 24px;
      font-size: 16px;
      background: #00a87d;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    #download-btn:hover {
      background: #008a65;
    }

    @media print {
      #download-btn {
        display: none;
      }
    }
  </style>
</head>
<body>

<div class="resume-container" id="resume-content">
  <h1 id="preview-name">Your Name</h1>
  <div class="location" id="preview-location">Location</div>
  <div class="contact-info" id="preview-contact">Email | Phone | LinkedIn | Portfolio</div>
  <div class="section" id="preview-description"></div>

  <div class="divider"></div>

  <div class="section">
    <h2>Skills</h2>
    <ul id="preview-skills"></ul>
  </div>

  <div class="section">
    <h2>Education</h2>
    <div id="preview-education"></div>
  </div>

  <div class="section">
    <h2>Projects</h2>
    <div id="preview-projects"></div>
  </div>

  <div class="section">
    <h2>Certificates</h2>
    <div id="preview-certificates"></div>
  </div>

  <div class="section">
    <h2>Experience</h2>
    <div id="preview-experience"></div>
  </div>
</div>

<button id="download-btn">Download Resume (PDF)</button>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
<script>
  const data = JSON.parse(localStorage.getItem("resumeData"));
  if (!data) return;

  document.getElementById("preview-name").textContent = data.name || "";
  document.getElementById("preview-location").textContent = data.location || "";

  const contact = [];
  if (data.email) contact.push(data.email);
  if (data.phone) contact.push(data.phone);
  if (data.linkedin) contact.push(data.linkedin);
  if (data.portfolio) contact.push(data.portfolio);
  document.getElementById("preview-contact").textContent = contact.join(" | ");

  document.getElementById("preview-description").textContent = data.description || "";

  const skillList = document.getElementById("preview-skills");
  data.skills?.forEach(skill => {
    const li = document.createElement("li");
    li.textContent = skill;
    skillList.appendChild(li);
  });

  const eduContainer = document.getElementById("preview-education");
  data.education?.forEach(e => {
    const div = document.createElement("div");
    div.innerHTML = `
      <strong>${e.degree}</strong><br>
      ${e.institution} (${e.year})<br>
      Marks: ${e.marks}<br><br>
    `;
    eduContainer.appendChild(div);
  });

  const projContainer = document.getElementById("preview-projects");
  data.projects?.forEach(p => {
    if (p.name || p.desc || p.link) {
      const div = document.createElement("div");
      div.innerHTML = `
        <strong>${p.name}</strong><br>
        ${p.desc}<br>
        ${p.link ? `<a href="${p.link}" target="_blank">${p.link}</a>` : ""}<br><br>
      `;
      projContainer.appendChild(div);
    }
  });

  const certContainer = document.getElementById("preview-certificates");
  data.certificates?.forEach(c => {
    const div = document.createElement("div");
    div.innerHTML = `<strong>${c.title}</strong> from ${c.org} (${c.date})<br><br>`;
    certContainer.appendChild(div);
  });

  const expContainer = document.getElementById("preview-experience");
  data.experience?.forEach(e => {
    const div = document.createElement("div");
    div.innerHTML = `<strong>${e.title}</strong> at ${e.company} (${e.duration})<br>${e.description}<br><br>`;
    expContainer.appendChild(div);
  });

  document.getElementById("download-btn").addEventListener("click", () => {
    html2pdf().from(document.getElementById("resume-content")).set({
      margin: 0.5,
      filename: "Eleve_Resume.pdf",
      image: { type: "jpeg", quality: 0.98 },
      html2canvas: { scale: 2, useCORS: true },
      jsPDF: { unit: "in", format: "a4", orientation: "portrait" }
    }).save();
  });
</script>

</body>
</html>
